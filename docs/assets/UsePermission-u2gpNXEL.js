import{r as n,j as o}from"./index-tHW-mALI.js";import{u as m}from"./useSyncExternalStore-j4BMwoY5.js";function l(){const c=navigator.userAgent;let r;return c.match(/chrome|chromium|crios/i)?r="chrome":c.match(/firefox|fxios/i)?r="firefox":c.match(/safari/i)?r="safari":c.match(/opr/i)?r="opera":c.match(/edg/i)?r="edge":r="No detection",r}const p=["accelerometer","background-fetch","bluetooth","camera","display-capture","geolocation","gyroscope","magnetometer","microphone","midi","nfc","notifications","push","screen-wake-lock","speaker-selection"],d=["geolocation","notifications","push","persistent-storage","midi","storage_access","screen-wake-lock"],f=["geolocation","notifications","push","midi","camera","microphone","background-fetch","background-sync","persistent-storage","ambient-light-sensor","accelerometer","gyroscope","magnetometer","screen-wake-lock","nfc","display-capture","accessibility-events","clipboard-read","clipboard-write","payment-handler","idle-detection","periodic-background-sync","system-wake-lock","storage-access","window-management","window-placement","local-fonts","top-level-storage-access","captured-surface-control"];function s(c){const r=n.useRef("asking"),a=n.useRef(!1),t=n.useRef();a.current||(a.current=!0,navigator.permissions.query({name:c}).then(e=>{r.current=e.state,e.onchange=()=>{r.current=e.state,t.current&&t.current()},t.current&&t.current()}).catch(()=>{const e=l();e==="firefox"&&!d.includes(c)&&(r.current="not supported",t.current&&t.current()),e==="safari"&&!p.includes(c)&&(r.current="not supported",t.current&&t.current()),["edge","chrome","opera"].includes(e)&&!f.includes(c)&&(r.current="not supported",t.current&&t.current()),e==="No detection"&&(r.current="prompt",t.current&&t.current())}));const i=n.useCallback(()=>navigator.permissions.query({name:c}).then(e=>(r.current=e.state,e.onchange=()=>{r.current=e.state,t.current&&t.current()},t.current&&t.current(),e.state)).catch(e=>{const u=l();if(u==="firefox"&&!d.includes(c)||u==="safari"&&!p.includes(c)||["edge","chrome","opera"].includes(u)&&!f.includes(c))return"not supported";throw e}),[c]);return[m(n.useCallback(e=>(t.current=e,()=>{t.current=void 0}),[]),n.useMemo(()=>{let e="asking";return()=>(e!==r.current&&(e=r.current),e)},[])),i]}const x=()=>{const[c]=s("accelerometer"),[r]=s("camera"),[a]=s("microphone"),[t]=s("notifications"),[i]=s("speaker-selection");return o.jsxs("div",{children:[o.jsxs("p",{children:["accelerometer: ",c]}),o.jsxs("p",{children:["camera: ",r]}),o.jsxs("p",{children:["microphone: ",a]}),o.jsxs("p",{children:["notifications: ",t]}),o.jsxs("p",{children:["speaker: ",i]})]})};export{x as UsePermission};
