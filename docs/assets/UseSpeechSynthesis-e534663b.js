import{r as i,j as n}from"./index-75043133.js";import{u as F}from"./useSyncExternalStore-4a64d9ce.js";const w=e=>{const l=i.useRef("speechSynthesis"in window),d=i.useRef(window&&window.speechSynthesis),h=i.useRef(),o=i.useRef(l?"ready":"unavailable"),u=i.useRef(c=>t=>{o.current="speaking",h.current&&h.current(),c&&c.call(t.utterance,t)}),g=i.useRef(c=>t=>{o.current="paused",h.current&&h.current(),c&&c.call(t.utterance,t)}),r=i.useRef(c=>t=>{o.current="speaking",h.current&&h.current(),c&&c.call(t.utterance,t)}),m=i.useRef(c=>t=>{o.current==="paused"&&d.current.cancel(),o.current="end",h.current&&h.current(),c&&c.call(t.utterance,t)}),j=i.useRef(c=>t=>{if(e!=null&&e.onCancel&&["canceled","interrupted"].includes(t.error)){o.current="ready";const{charIndex:a,charLength:s,elapsedTime:x,utterance:v}=t;e.onCancel.call(t.utterance,{charIndex:a,charLength:s,elapsedTime:x,utterance:v,name:"oncancel"})}else o.current="error",c&&c.call(t.utterance,t);h.current&&h.current()}),b=i.useRef(c=>{if(!l.current)return;const{text:t,...a}=typeof c=="string"?{text:c}:c,s=new SpeechSynthesisUtterance(t);a.lang&&(s.lang=a.lang),a.pitch&&(s.pitch=a.pitch),a.rate&&(s.rate=a.rate),a.voice&&(s.voice=a.voice),a.volume&&(s.volume=a.volume);const x=u.current(a.onStart??(e==null?void 0:e.onStart)),v=g.current(a.onPause??(e==null?void 0:e.onPause)),E=r.current(a.onResume??(e==null?void 0:e.onResume)),C=m.current(a.onEnd??(e==null?void 0:e.onEnd)),P=j.current(a.onError??(e==null?void 0:e.onError)),f=a.onBoundary||(e==null?void 0:e.onBoundary),y=a.onMark||(e==null?void 0:e.onMark);s.onstart=x,s.onpause=v,s.onresume=E,s.onend=C,s.onerror=P,f&&(s.onboundary=f),y&&(s.onmark=y),(o.current==="paused"||a.startImmediatly)&&d.current.cancel(),["ready","end","error"].includes(o.current)&&(e!=null&&e.onSpeak)&&(e==null||e.onSpeak()),d.current.speak(s)}),k=i.useRef(()=>l.current&&o.current==="speaking"&&d.current.pause()),S=i.useRef(()=>l.current&&o.current==="paused"&&d.current.resume()),R=i.useRef(()=>l.current&&d.current.cancel()),p=F(i.useCallback(c=>{h.current=c;const t=()=>c();return l.current&&d.current.addEventListener("voiceschanged",t),()=>{h.current=void 0,l.current&&d.current.removeEventListener("voiceschanged",t)}},[]),i.useMemo(()=>{let c={isSupported:l.current,status:o.current,hasPending:l.current?d.current.pending:!1,voices:l.current?d.current.getVoices():null};return()=>{var a,s;const t={status:o.current,hasPending:l.current?d.current.pending:!1,voices:l.current?d.current.getVoices():null};return(t.status!==c.status||t.hasPending!==c.hasPending||((a=t.voices)==null?void 0:a.length)!==((s=c.voices)==null?void 0:s.length))&&(c={isSupported:l.current,status:t.status,hasPending:t.hasPending,voices:t.voices}),c}},[]));return i.useMemo(()=>({state:p,speak:b.current,pause:k.current,resume:S.current,cancel:R.current}),[p])},V=()=>{const{state:e,speak:l,pause:d,resume:h,cancel:o}=w({onError(r){console.log(r)}}),[u,g]=i.useState({text:"",volume:"0.1",voice:"",lang:"",rate:"1",pitch:"1"});return e.isSupported?n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10,justifyContent:"center",width:"fit-content"},children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"text",children:"Text to speak"}),n.jsx("input",{type:"text",value:u.text,onChange:r=>g(m=>({...m,text:r.target.value})),id:"text",name:"text"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"text",children:"Voices"}),n.jsx("select",{value:u.voice,onChange:r=>g(m=>({...m,voice:r.target.value})),disabled:e.status==="speaking",children:n.jsx(n.Fragment,{children:(e.voices||[]).map(r=>n.jsx("option",{value:r.name,children:`${r.name} - ${r.lang}${r.default?" - DEFAULT":""}`},r.name))})})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"text",children:"Voices"}),n.jsx("select",{value:u.lang,onChange:r=>g(m=>({...m,lang:r.target.value})),disabled:e.status==="speaking",children:n.jsx(n.Fragment,{children:["en-US","it-IT","en-GB","de-DE","es-ES","fr-FR"].map(r=>n.jsx("option",{value:r,children:`${r}`},r))})})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"volume",children:"Volume"}),n.jsx("input",{type:"range",id:"volume",name:"volume",min:"0",max:"1",step:"0.1",value:u.volume,onChange:r=>g(m=>({...m,volume:r.target.value})),disabled:e.status==="speaking"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"range",children:"Rate"}),n.jsx("input",{type:"range",id:"range",name:"range",min:"0.1",max:"10",step:"0.1",value:u.rate,onChange:r=>g(m=>({...m,rate:r.target.value})),disabled:e.status==="speaking"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"pitch",children:"Pitch"}),n.jsx("input",{type:"range",id:"pitch",name:"pitch",value:u.pitch,min:"0",max:"2",step:"0.1",onChange:r=>g(m=>({...m,pitch:r.target.value})),disabled:e.status==="speaking"})]}),n.jsxs("div",{style:{display:"flex",gap:10},children:[n.jsx("button",{type:"button",onClick:()=>{l({text:u.text,lang:u.lang,voice:(e.voices||[]).filter(r=>r.name===u.voice)[0],volume:Number(u.volume),rate:Number(u.rate),pitch:Number(u.pitch)})},disabled:e.status==="paused",children:"Speak"}),n.jsx("button",{type:"button",onClick:()=>{l({text:u.text,lang:u.lang,voice:(e.voices||[]).filter(r=>r.name===u.voice)[0],volume:Number(u.volume),rate:Number(u.rate),pitch:Number(u.pitch),startImmediatly:!0})},children:"Speak immediatly"}),n.jsx("button",{type:"button",onClick:()=>{e.status==="paused"?h():d()},disabled:!["speaking","paused"].includes(e.status),children:e.status==="paused"?"Resume":"Pause"}),n.jsx("button",{type:"button",onClick:o,disabled:e.status==="end",children:"Cancel"})]})]}):n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("p",{children:"Speech Synthesis not supported"})})};export{V as UseSpeechSynthesis};
