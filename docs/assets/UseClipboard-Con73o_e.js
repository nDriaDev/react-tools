import{r as n,j as r}from"./index-27nyValZ.js";import{u as C}from"./useSyncExternalStore-Atv6g5DE.js";const g=u=>navigator.permissions.query({name:u}).then(l=>{if(l.state==="denied")throw Error(`Permission to ${u.includes("read")?"copy to":"paste from"} Clipboard denied.`)}).catch(l=>{throw l}),j=()=>navigator.clipboard.read===void 0;function w({useValue:u,dataType:l,target:c}){const i=n.useRef(""),d=n.useRef(),a=n.useRef();n.useRef(t=>navigator.clipboard.write(Array.isArray(t)?t.map(e=>new ClipboardItem({[e.type]:e})):[new ClipboardItem({[t.type]:t})]).then(()=>{i.current=t,a.current&&a.current()}).catch(e=>{throw e}));const x=n.useRef(t=>navigator.clipboard.writeText(t).then(()=>{i.current=t,a.current&&a.current()}).catch(e=>{throw e}));n.useRef(()=>i.current||j()?Promise.resolve(i.current):g("clipboard-read").then(()=>navigator.clipboard.read()).then(t=>{const e=[];for(const s of t)for(let o=0,p=s.types.length;o<p;o++)e.push(s.getType(s.types[o]));return Promise.all(e)}).then(t=>Promise.all(t.map(e=>e.type.includes("text")?e.text():Promise.resolve(e)))).then(t=>(i.current=t,t)).catch(t=>{throw t}));const f=n.useRef(()=>i.current||j()?Promise.resolve(i.current):g("clipboard-read").then(()=>navigator.clipboard.read()).then(t=>{const e=[];for(const s of t)for(let o=0,p=s.types.length;o<p;o++)s.types[o]==="text/plain"&&e.push(s.getType(s.types[o]));return Promise.all(e)}).then(t=>Promise.all(t.map(e=>e.text()))).then(t=>(i.current=t[0],i.current)).catch(t=>{throw t}));return[C(n.useCallback(t=>{a.current=t;const e=c?c!=null&&c.current?c.current:c:document,s=o=>{var p;if(["cut","copy"].includes(o.type))i.current=((p=getSelection())==null?void 0:p.toString())??"",t();else{const h=[],{clipboardData:v}=o;if(v!==null){const b=v.items;for(const y of b)y.type==="text/plain"&&h.push(v.getData(y.type))}i.current=h.length===1?h[0]:h,t()}};return e==null||e.addEventListener("cut",s,{passive:!0}),e==null||e.addEventListener("copy",s,{passive:!0}),e==null||e.addEventListener("cut",s,{passive:!0}),()=>{a.current=void 0,e==null||e.removeEventListener("cut",s),e==null||e.removeEventListener("copy",s),e==null||e.removeEventListener("cut",s)}},[c,l]),n.useCallback(()=>(d.current!==i.current&&(d.current=i.current),d.current),[u])),x.current,f.current]}const P=()=>{const u=n.useRef(null),[l,c]=n.useState(""),[i,d,a]=w({useValue:!0,target:u,dataType:"text"}),x=n.useCallback(async()=>{var m;await d(((m=getSelection())==null?void 0:m.toString())||"")},[d]),f=n.useCallback(async()=>{const m=await a();c(m)},[a]);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"50% 50%",columnGap:15},children:[r.jsxs("div",{ref:u,style:{position:"relative",border:"1px solid lightgray"},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 100px",justifyContent:"center",columnGap:15},children:[r.jsx("button",{onClick:x,children:"Copy"}),r.jsx("button",{onClick:f,children:"Paste"})]}),r.jsx("div",{children:r.jsx("p",{children:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Incidunt repudiandae fugit distinctio molestiae excepturi ex qui, impedit iste odit. Explicabo quis reprehenderit voluptates reiciendis nostrum minima autem temporibus sint doloribus"})}),r.jsx("div",{children:r.jsx("p",{children:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Incidunt repudiandae fugit distinctio molestiae excepturi ex qui, impedit iste odit. Explicabo quis reprehenderit voluptates reiciendis nostrum minima autem temporibus sint doloribus"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:15,border:"1px solid lightgray"},children:[r.jsxs("div",{style:{textAlign:"left",padding:"0 1em",maxHeight:300,overflow:"auto"},children:[r.jsx("p",{children:r.jsx("strong",{children:"Use ClipboardValue:"})}),r.jsx("pre",{children:JSON.stringify(i,null,2)})]}),r.jsxs("div",{style:{textAlign:"left",padding:"0 1em",maxHeight:300,overflow:"auto"},children:[r.jsx("p",{children:r.jsx("strong",{children:"Internal value:"})}),r.jsx("pre",{children:JSON.stringify(l,null,2)})]})]})]})};export{P as UseClipboard};
