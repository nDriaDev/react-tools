import{r as t,j as n}from"./index-27nyValZ.js";import{u as f}from"./useEffectOnce-DHwcJzMV.js";import{u as x}from"./useSyncExternalStore-Atv6g5DE.js";function v(r){const c=t.useRef(),i=t.useRef(),l=t.useRef(),s=t.useRef({isVisible:!1,ratio:0}),u=t.useRef({isVisible:!1,ratio:0});f(()=>()=>{var e;c.current=void 0,(e=i.current)==null||e.disconnect(),i.current=void 0});const h=t.useCallback(e=>{e&&e&&(!c.current||c.current!==e)&&(c.current=e,i.current=new IntersectionObserver(b=>{const{isIntersecting:o,intersectionRatio:d}=b[0];u.current={isVisible:o,ratio:d},(o!==s.current.isVisible||d!==s.current.ratio)&&l.current&&l.current()},{root:r==null?void 0:r.root,rootMargin:r==null?void 0:r.rootMargin,threshold:r==null?void 0:r.threshold}),i.current.observe(e))},[r==null?void 0:r.root,r==null?void 0:r.rootMargin,r==null?void 0:r.threshold]),a=x(t.useCallback(e=>(l.current=e,()=>{l.current=void 0}),[]),t.useCallback(()=>((u.current.isVisible!==s.current.isVisible||u.current.ratio!==s.current.ratio)&&(s.current=u.current),s.current),[r==null?void 0:r.withRatio]));return[h,a.isVisible,a.ratio]}const j=()=>{const[r,c,i]=v({threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],withRatio:!0});return n.jsxs("div",{children:[n.jsxs("div",{style:{marginTop:16,color:i===1?"#98c379":i===0?"#e46962":"#d2c04c"},children:[n.jsxs("p",{children:["isVisible: ",c?"visible":"hidden"]}),n.jsxs("p",{children:["ratio: ",i]})]}),n.jsxs("div",{style:{margin:"auto",width:300,height:300,overflow:"scroll",border:"1px solid"},children:[n.jsx("p",{children:"scrollable div"}),n.jsx("div",{style:{height:800},children:n.jsx("div",{ref:r,style:{border:"1px solid",margin:"320px auto 0px",height:100,width:100,textAlign:"center"},children:"bordered div"})})]})]})};export{j as UseVisible};
