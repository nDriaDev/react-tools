import{r as n,j as u}from"./index-iAsfR5zi.js";import{u as d}from"./useEffectOnce-zk4Nmawj.js";const b=({url:s,options:m,onMessage:c,onError:o,onMessageError:a})=>{const e=n.useRef(),g=n.useCallback((r,t)=>{var i,l;Array.isArray(t)?(i=e.current)==null||i.postMessage(r,t):(l=e.current)==null||l.postMessage(r,t)},[]),p=n.useCallback(()=>{var r;(r=e.current)==null||r.terminate(),e.current=void 0},[]);return d(()=>{const r=s instanceof URL?s:new URL(s,import.meta.url);return e.current=new Worker(r,m),e.current.onerror=t=>{o&&o(t)},e.current.onmessageerror=t=>{a&&a(t)},e.current.onmessage=t=>{c&&c(t)},()=>{var t;(t=e.current)==null||t.terminate(),e.current=void 0}}),{send:g,terminate:p}},w=()=>{const[s,m]=n.useState(Date.now()),[c,o]=n.useState(""),{send:a}=b({url:new URL("data:video/mp2t;base64,ZnVuY3Rpb24gaGVhdnlUYXNrKCkgewoJY29uc3QgbnVtYmVyczogbnVtYmVyW10gPSBBcnJheSg1NV8wMDBfMDAwKS5maWxsKHRydWUpLm1hcCgoKSA9PiBNYXRoLnJhbmRvbSgpICogMTEpCglyZXR1cm4gbnVtYmVycy5zbGljZSgwLCA1KS5tYXAoZWwgPT4gTWF0aC5mbG9vcihlbCkpCn0KCnNlbGYub25tZXNzYWdlID0gKCkgPT4gewoJY29uc3QgcmVzID0gaGVhdnlUYXNrKCk7CglzZWxmLnBvc3RNZXNzYWdlKHsgcmVzIH0pOwp9Cg==",import.meta.url),onMessage:n.useCallback(e=>{o(e.data.res.join(","))},[])});return n.useEffect(()=>{const e=setInterval(()=>m(Date.now()),1);return()=>clearInterval(e)},[]),u.jsxs("div",{children:[u.jsxs("p",{children:["Timestamp: ",s]}),u.jsxs("p",{children:["Result: ",c||""]}),u.jsx("button",{onClick:()=>{o("Pending..."),a("heavyTask")},children:"START"})]})};export{w as UseWebWorker};
