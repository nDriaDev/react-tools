import{r as n,a as E,j as r}from"./index-7iLlK_Uu.js";import{u as R}from"./useRerender-GR08ZFNS.js";import{u as S}from"./useEffectOnce-TlMyHqBR.js";const W=({options:{inheritCSS:m,window:e}={window:{height:300,width:450}},onOpen:o,onOpened:i,onClose:a,onError:d})=>{const P="documentPictureInPicture"in window,f=n.useRef(!1),c=n.useRef(),x=R(),l=n.useRef(P?window.documentPictureInPicture:null),C=n.useCallback(t=>{i&&i(t)},[i]),k=n.useCallback(async t=>{var j,w;try{const h=((j=t==null?void 0:t.window)==null?void 0:j.width)??(e==null?void 0:e.width),I=((w=t==null?void 0:t.window)==null?void 0:w.height)??(e==null?void 0:e.height);if(!l.current||!h||!I)return Promise.resolve();o&&o();const p=await l.current.requestWindow({width:h,height:I});p.addEventListener("pagehide",u=>{a&&a(u),c.current=void 0},{capture:!0,once:!0}),(t!=null&&t.inheritCSS||m)&&[...document.styleSheets].forEach(u=>{try{const g=[...u.cssRules].map(y=>y.cssText).join(""),s=document.createElement("style");s.textContent=g,p.document.head.appendChild(s)}catch{const s=document.createElement("link");if(u.href==null)return;s.rel="stylesheet",s.type=u.type,s.media=u.media.toString(),s.href=u.href,p.document.head.appendChild(s)}}),c.current=p,x()}catch(h){if(d)d(h);else throw h}},[a,d,o,m,e==null?void 0:e.height,e==null?void 0:e.width,x]),b=n.useCallback(()=>{c.current&&c.current.close(),x()},[x]),v=n.useMemo(()=>({children:t})=>c.current?E.createPortal(t,c.current.document.body):null,[]);return l.current&&!f.current&&(f.current=!0,l.current.addEventListener("enter",C)),S(()=>()=>{l.current&&l.current.removeEventListener("enter",C)}),{isSupported:P,openPIP:k,PipWindow:v,closePIP:b}},A=()=>{const[m,e]=n.useState(!0),[o,i]=n.useState(0),{isSupported:a,openPIP:d,PipWindow:P,closePIP:f}=W({onOpened:n.useCallback(()=>e(!1),[]),onClose:n.useCallback(()=>e(!0),[])});return r.jsxs("div",{children:[r.jsx("p",{children:"Window Counter"}),r.jsx("button",{onClick:()=>i(c=>c+1),children:o}),r.jsxs("p",{children:["Supported: ",a?"Yes":"No"]}),m&&r.jsx(r.Fragment,{children:r.jsx("div",{children:r.jsx("button",{onClick:()=>d({inheritCSS:!0}),children:"Open PIP"})})}),r.jsx(P,{children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",gap:20},children:[r.jsx("h4",{style:{textAlign:"center"},children:"PIP Window Counter"}),r.jsx("button",{onClick:()=>i(c=>c+1),children:o}),r.jsx("button",{onClick:f,children:"Close"})]})})]})};export{A as UseDocumentPIP};
