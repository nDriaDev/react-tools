import{r as n,j as t}from"./index-09xe1hXZ.js";import{u as f}from"./useEffectOnce-bsixCVVZ.js";import{u as x}from"./useSyncExternalStore-XynnNRs2.js";function v(r){const l=n.useRef(),i=n.useRef(),u=n.useRef(),c=n.useRef({isVisible:!1,ratio:0}),s=n.useRef({isVisible:!1,ratio:0});f(()=>()=>{var e;l.current=void 0,(e=i.current)==null||e.disconnect(),i.current=void 0});const d=n.useCallback(e=>{e&&e&&(!l.current||l.current!==e)&&(l.current=e,i.current=new IntersectionObserver(b=>{const{isIntersecting:h,intersectionRatio:o}=b[0];s.current={isVisible:h,ratio:o},(h!==c.current.isVisible||o!==c.current.ratio)&&u.current&&u.current()},{root:r==null?void 0:r.root,rootMargin:r==null?void 0:r.rootMargin,threshold:r==null?void 0:r.threshold}),i.current.observe(e))},[r==null?void 0:r.root,r==null?void 0:r.rootMargin,r==null?void 0:r.threshold]),a=x(n.useCallback(e=>(u.current=e,()=>{u.current=void 0}),[]),n.useCallback(()=>((s.current.isVisible!==c.current.isVisible||s.current.ratio!==c.current.ratio)&&(c.current=s.current),r!=null&&r.withRatio?c.current:c.current.isVisible),[r==null?void 0:r.withRatio]));return r!=null&&r.withRatio?[d,a.isVisible,a.ratio]:[d,a]}const j=()=>{const[r,l,i]=v({threshold:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],withRatio:!0});return t.jsxs("div",{children:[t.jsxs("div",{style:{marginTop:16,color:i===1?"#98c379":i===0?"#e46962":"#d2c04c"},children:[t.jsxs("p",{children:["isVisible: ",l?"visible":"hidden"]}),t.jsxs("p",{children:["ratio: ",i]})]}),t.jsxs("div",{style:{margin:"auto",width:300,height:300,overflow:"scroll",border:"1px solid"},children:[t.jsx("p",{children:"scrollable div"}),t.jsx("div",{style:{height:800},children:t.jsx("div",{ref:r,style:{border:"1px solid",margin:"320px auto 0px",height:100,width:100,textAlign:"center"},children:"bordered div"})})]})]})};export{j as UseVisible};
