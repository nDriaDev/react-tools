import{r as s,j as r}from"./index-0wVqskhd.js";import{u as E}from"./useSyncExternalStore-DXEdMsTG.js";const b=l=>navigator.permissions.query({name:l}).then(c=>{if(c.state==="denied")throw Error(`Permission to ${l.includes("read")?"copy to":"paste from"} Clipboard denied.`)}).catch(c=>{throw c}),j=()=>navigator.clipboard.read===void 0;function R({useValue:l,dataType:c,target:d}){const i=s.useRef(""),f=s.useRef(),p=s.useRef(),y=s.useRef(t=>navigator.clipboard.write(Array.isArray(t)?t.map(e=>new ClipboardItem({[e.type]:e})):[new ClipboardItem({[t.type]:t})]).then(()=>{i.current=t,p.current&&p.current()}).catch(e=>{throw e})),g=s.useRef(t=>navigator.clipboard.writeText(t).then(()=>{i.current=t,p.current&&p.current()}).catch(e=>{throw e})),m=s.useRef(()=>i.current||j()?Promise.resolve(i.current):b("clipboard-read").then(()=>navigator.clipboard.read()).then(t=>{const e=[];for(const n of t)for(let u=0,x=n.types.length;u<x;u++)e.push(n.getType(n.types[u]));return Promise.all(e)}).then(t=>Promise.all(t.map(e=>e.type.includes("text")?e.text():Promise.resolve(e)))).then(t=>(i.current=t,t)).catch(t=>{throw t})),w=s.useRef(()=>i.current||j()?Promise.resolve(i.current):b("clipboard-read").then(()=>navigator.clipboard.read()).then(t=>{const e=[];for(const n of t)for(let u=0,x=n.types.length;u<x;u++)n.types[u]==="text/plain"&&e.push(n.getType(n.types[u]));return Promise.all(e)}).then(t=>Promise.all(t.map(e=>e.text()))).then(t=>(i.current=t[0],i.current)).catch(t=>{throw t})),C=E(s.useCallback(t=>{p.current=t;const e=d?d!=null&&d.current?d.current:d:document,n=u=>{var x;if(["cut","copy"].includes(u.type))c==="text"||j()?(i.current=((x=getSelection())==null?void 0:x.toString())??"",t()):b("clipboard-read").then(()=>navigator.clipboard.read()).then(o=>{const a=[];for(const v of o)for(let h=0,P=v.types.length;h<P;h++)a.push(v.getType(v.types[h]));return Promise.all(a)}).then(o=>Promise.all(o.map(a=>a.type.includes("text")?a.text():Promise.resolve(a)))).then(o=>{i.current=o,t()});else{const o=[],{clipboardData:a}=u;if(a!==null){const v=a.items;for(const h of v)c==="text"?h.type==="text/plain"&&o.push(a.getData(h.type)):h.kind==="string"?o.push(a.getData(h.type)):o.push(h.getAsFile())}i.current=o.length===1?o[0]:o,t()}};return e==null||e.addEventListener("cut",n,{passive:!0}),e==null||e.addEventListener("copy",n,{passive:!0}),e==null||e.addEventListener("cut",n,{passive:!0}),()=>{p.current=void 0,e==null||e.removeEventListener("cut",n),e==null||e.removeEventListener("copy",n),e==null||e.removeEventListener("cut",n)}},[d,c]),s.useCallback(()=>l?(f.current!==i.current&&(f.current=i.current),f.current):"",[l]));return l?c==="text"?[C,g.current,w.current]:[C,y.current,m.current]:c==="text"?[g.current,w.current]:[y.current,m.current]}const L=()=>{const l=s.useRef(null),[c,d]=s.useState(""),[i,f,p]=R({useValue:!0,target:l,dataType:"text"}),y=s.useCallback(async()=>{var m;await f(((m=getSelection())==null?void 0:m.toString())||"")},[f]),g=s.useCallback(async()=>{const m=await p();d(m)},[p]);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"50% 50%",columnGap:15},children:[r.jsxs("div",{ref:l,style:{position:"relative",border:"1px solid lightgray"},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 100px",justifyContent:"center",columnGap:15},children:[r.jsx("button",{onClick:y,children:"Copy"}),r.jsx("button",{onClick:g,children:"Paste"})]}),r.jsx("div",{children:r.jsx("p",{children:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Incidunt repudiandae fugit distinctio molestiae excepturi ex qui, impedit iste odit. Explicabo quis reprehenderit voluptates reiciendis nostrum minima autem temporibus sint doloribus"})}),r.jsx("div",{children:r.jsx("p",{children:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Incidunt repudiandae fugit distinctio molestiae excepturi ex qui, impedit iste odit. Explicabo quis reprehenderit voluptates reiciendis nostrum minima autem temporibus sint doloribus"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:15,border:"1px solid lightgray"},children:[r.jsxs("div",{style:{textAlign:"left",padding:"0 1em",maxHeight:300,overflow:"auto"},children:[r.jsx("p",{children:r.jsx("strong",{children:"Use ClipboardValue:"})}),r.jsx("pre",{children:JSON.stringify(i,null,2)})]}),r.jsxs("div",{style:{textAlign:"left",padding:"0 1em",maxHeight:300,overflow:"auto"},children:[r.jsx("p",{children:r.jsx("strong",{children:"Internal value:"})}),r.jsx("pre",{children:JSON.stringify(c,null,2)})]})]})]})};export{L as UseClipboard};
