import{r as o,j as a}from"./index-9ecbe31f.js";const x=({target:e,unadjustedMovement:l,onLock:n,onUnlock:t,onError:s})=>{const r=o.useRef(!1),u=o.useCallback(()=>{document.pointerLockElement?n&&n(document.pointerLockElement):(r.current=!1,document.removeEventListener("pointerlockerror",s,!1),document.removeEventListener("pointerlockchange",u),t&&t(e!=null&&e.current?e.current:e))},[s,n,t,e]),f=o.useCallback(async()=>{r.current=!1,await document.exitPointerLock(),t&&t(e!=null&&e.current?e.current:e)},[e,t]);return{lock:o.useCallback(()=>{const i=e!=null&&e.current?e.current:e;return new Promise(h=>!i||r.current?h():(document.addEventListener("pointerlockerror",s,!1),document.addEventListener("pointerlockchange",u),i.requestPointerLock({unadjustedMovement:!!l}).then(()=>{r.current=!0}).catch(d=>{s(d)}).finally(()=>{h()})))},[e,s,l,u]),unlock:f}},L=(e,l,n)=>{const t=n.getContext("2d");function s(c,i){return c<20?c+=i:c+20>i?c-=i:c=0,c}function r(c,i){t.beginPath(),t.arc(c,i,20,0,2*Math.PI,!0),t.fill()}const u=s(e,n.width),f=s(l,n.height);t.fillStyle="black",t.fillRect(0,0,n.width,n.height),t.fillStyle="#f00",r(e,l),u&&r(u,l),f&&r(e,f),u&&f&&r(u,f)},p=()=>{const[e,l]=o.useState({x:0,y:0}),n=o.useRef(null),t=o.useRef(c=>{function i(h,d){l(v=>{let m=v.x+h.x,k=v.y+h.y;return m%=d.x,k%=d.y,m<0&&(m+=d.x),k<0&&(k+=d.y),L(m,k,n.current),{x:m,y:k}})}i({x:c.movementX,y:c.movementY},{x:n.current.width,y:n.current.height})}),s=o.useCallback(()=>alert("PointerLock API not supported."),[]),r=o.useCallback(()=>{n.current.addEventListener("mousemove",t.current)},[]),u=o.useCallback(()=>n.current.removeEventListener("mousemove",t.current),[]),{lock:f}=x({target:n,onError:s,onLock:r,onUnlock:u});return o.useLayoutEffect(()=>{n.current&&L(20,20,n.current)},[]),a.jsxs(a.Fragment,{children:[a.jsx("div",{children:e&&a.jsxs("p",{children:["Position X:",e.x," - Y:",e.y]})}),a.jsx("canvas",{ref:n,width:"640",height:"360",onClick:f,children:"Your browser does not support HTML5 canvas"})]})};export{p as UsePointerLock};
