import{r as f}from"./index-l3csZOL-.js";function m(i){const t=[];for(let a=0;a<i.length;a++)t.push({start:i.start(a),end:i.end(a)});return t}function p(i){return t=>{const[a,o]=f.useState({buffered:null,time:0,duration:0,paused:!0,muted:!1,volume:1,playbackRate:1,playing:!1}),r=f.useRef(null),s=(e,n)=>u=>{try{n&&n(u)}finally{e&&e(u)}},d=()=>o(e=>({...e,paused:!1})),g=()=>o(e=>({...e,playing:!0})),h=()=>o(e=>({...e,playing:!1})),y=()=>o(e=>({...e,paused:!0,playing:!1})),P=()=>{const e=r.current;e&&o(n=>({...n,muted:e.muted,volume:e.volume}))},M=()=>{const e=r.current;if(!e)return;const{duration:n,buffered:u}=e;o(l=>({...l,duration:n,buffered:m(u)}))},T=()=>{const e=r.current;e&&o(n=>({...n,time:e.currentTime}))},b=()=>{const e=r.current;e&&o(n=>({...n,buffered:m(e.buffered)}))},C=f.useMemo(()=>f.createElement(i,{controls:!1,...t,ref:r,onPlay:s(t.onPlay,d),onPlaying:s(t.onPlaying,g),onWaiting:s(t.onWaiting,h),onPause:s(t.onPause,y),onVolumeChange:s(t.onVolumeChange,P),onDurationChange:s(t.onDurationChange,M),onTimeUpdate:s(t.onTimeUpdate,T),onProgress:s(t.onProgress,b)}),[t]);let c=!1;return{MediaElement:C,state:a,controls:{play:()=>{const e=r.current;if(e&&!c){const n=e.play();if(typeof n=="object"){c=!0;const l=()=>{c=!1};n.then(l,l)}return n}},pause:()=>{const e=r.current;if(e&&!c)return e.pause()},seek:e=>{const n=r.current;!n||a.duration===void 0||(e=Math.min(a.duration,Math.max(0,e)),n.currentTime=e)},playbackRate:e=>{const n=r.current;n&&(e=Math.min(1,Math.max(0,e)),n.playbackRate=e,o(u=>({...u,playbackRate:e})))},volume:e=>{const n=r.current;n&&(e=Math.min(1,Math.max(0,e)),n.volume=e,o(u=>({...u,volume:e})))},mute:()=>{const e=r.current;e&&(e.muted=!0)},unmute:()=>{const e=r.current;e&&(e.muted=!1)}},ref:r}}}export{p as c};
