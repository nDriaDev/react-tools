import{r as o,j as t}from"./index-LfmzCjXr.js";import{u as w}from"./useLazyRef-nowTrP_8.js";import{u as E}from"./useMergedRef-7toiIxr0.js";import{u as y}from"./useSyncExternalStore--wyZB9C7.js";let L=0;const j=()=>`:${(L++).toString(32)}:`;function k(){return w(j).current}const R=o.useId===void 0?k:o.useId;function S({mode:n,onBeforeToggle:s,onToggle:c}){const v="showPopover"in document.body,p=R(),a=o.useRef(!1),l=o.useRef(),u=o.useCallback(e=>{s&&s(e)},[s]),i=o.useCallback(e=>{console.log("onToggle"),a.current=e.newState==="open",c&&c(e),l.current&&l.current()},[c]),h=o.useCallback(e=>{e&&(e.removeEventListener("beforetoggle",u),e.removeEventListener("toggle",i),e.addEventListener("beforetoggle",u),e.addEventListener("toggle",i))},[u,i]),r=o.useRef(null),f=E(r,h),m=o.useMemo(()=>({children:e,...d})=>"showPopover"in document.body&&t.jsx("div",{id:p,ref:f,popover:n,...d,children:e}),[p,n,f]),b=y(o.useCallback(e=>(l.current=e,()=>{l.current=void 0}),[]),o.useCallback(()=>a.current,[])),P=o.useCallback(()=>{"showPopover"in document.body&&r.current&&r.current.showPopover()},[]),x=o.useCallback(()=>{"showPopover"in document.body&&r.current&&r.current.hidePopover()},[]),C=o.useCallback(()=>{"showPopover"in document.body&&r.current&&r.current.togglePopover()},[]);return r.current&&setTimeout(()=>{var e;r.current&&(r.current.removeEventListener("beforetoggle",u),r.current.removeEventListener("toggle",i),a.current&&((e=r.current)==null||e.showPopover()),setTimeout(()=>{var d,g;(d=r.current)==null||d.addEventListener("beforetoggle",u),(g=r.current)==null||g.addEventListener("toggle",i)},1))},1),{isSupported:v,isOpen:b,showPopover:P,hidePopover:x,togglePopover:C,Popover:m}}const N=()=>{const{Popover:n,isSupported:s,isOpen:c,showPopover:v}=S({mode:"auto"}),p=o.useMemo(()=>({width:300,height:200,position:"absolute"}),[]);return t.jsxs("div",{children:[t.jsxs("p",{children:["Is supported: ",s?"Yes":"No"]}),t.jsx("button",{onClick:v,disabled:c,children:"Open Popover"}),t.jsxs(n,{style:p,children:[t.jsx("h2",{children:"Popover heading"}),t.jsx("p",{children:"Popover content"})]})]})};export{N as UsePopover};
