import{r,j as s}from"./index-7b09dd01.js";import{Dropdown as h}from"./Dropdown-b7d8550e.js";import{Select as A}from"./Select-c98af4f8.js";import{u as S}from"./useEffectOnce-52b968b4.js";import"./useUpdate-dddcae22.js";const R=e=>{const[t,o]=r.useReducer(d=>d+1e-4,0),n=r.useDeferredValue(t),l=r.useRef(e),p=r.useRef();return r.useEffect(()=>{n!==0&&l.current()},[n]),r.useCallback((...d)=>{p.current=d,o()},[])},m=e=>{let t="script";for(const[o,n]of Object.entries(e))n&&(t+=`[${o}${typeof n=="boolean"?"":`="${n}"`}]`);return document.querySelector(t)},v=e=>{const t=document.createElement("script");return e.src&&(t.src=e.src),e.async&&(t.async=!0),e.defer&&(t.defer=!0),e.type&&t.setAttribute("type",e.type),e.crossorigin&&t.setAttribute("crossorigin",e.crossorigin),e.fetchpriority&&t.setAttribute("fetchpriority",e.fetchpriority),e.integrity&&t.setAttribute("integrity",e.integrity),e.nonce&&t.setAttribute("nonce",e.nonce),e.nomodule&&t.setAttribute("nomodule",e.nomodule.toString()),e.referrerpolicy&&t.setAttribute("referrerpolicy",e.referrerpolicy),t.setAttribute("data-status","loading"),t},C=function({attributes:e,options:t}){const o=r.useRef(t),n=r.useRef(e),[l,p]=r.useState(!o.current.handleAppending),a=r.useCallback((i,c)=>{n.current=i,o.current.iframe=c,p(y=>!y)},[]),d=r.useCallback(()=>{var c;const i=m(n.current);(c=i==null?void 0:i.parentElement)==null||c.removeChild(i)},[]);return S(()=>()=>{o.current.removeOnUnmount&&d()}),[b(r.useCallback(i=>{var c,y;if(l){let f,g=!0;f=m(n.current),f||(g=!1,f=v(n.current));const j=u=>{const x=m(n.current);x==null||x.setAttribute("data-status",u.type==="load"?"ready":"error"),i()};return f.addEventListener("load",j),f.addEventListener("error",j),!g&&(((y=(c=o.current.iframe)==null?void 0:c.contentWindow)==null?void 0:y.document)||document).body.appendChild(f),()=>{const u=m(n.current);u==null||u.removeEventListener("load",j),u==null||u.removeEventListener("error",j)}}else return()=>{}},[l]),r.useCallback(()=>{var c;return((c=m(n.current))==null?void 0:c.getAttribute("data-status"))??(o.current.handleAppending?"idle":"loading")},[])),a,d]};function E(e,t){const[o,n]=r.useState(t()),l=r.useRef(e),p=r.useRef(t),a=r.useCallback(()=>{n(p.current())},[]);return r.useEffect(()=>(a(),l.current(a)),[a]),o}const b=r.useSyncExternalStore===void 0?E:r.useSyncExternalStore,k=()=>{const e=r.useRef(null),[,t]=r.useReducer(n=>!n,!1),o=()=>{var n;return t(),(n=e.current)==null?void 0:n.click()};return s.jsxs("div",{children:[s.jsx("p",{children:s.jsx("strong",{children:"Component without performAction"})}),s.jsx(A,{action:o}),s.jsx("br",{}),s.jsx("br",{}),s.jsx(h,{btnRef:e})]})},N=()=>{const e=r.useRef(null),t=R(()=>{var o;return(o=e.current)==null?void 0:o.click()});return s.jsxs("div",{children:[s.jsx("p",{children:s.jsx("strong",{children:"Component with performAction"})}),s.jsx(A,{action:t}),s.jsx("br",{}),s.jsx("br",{}),s.jsx(h,{btnRef:e})]})},L=()=>{const[e]=C({attributes:{src:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js",integrity:"sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL",crossorigin:"anonymous"},options:{removeOnUnmount:!0}});return e==="loading"?null:s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"center",gap:50},children:[s.jsx(k,{}),s.jsx(N,{})]})};L.displayName="UsePerformAction";export{L as UsePerformAction};
