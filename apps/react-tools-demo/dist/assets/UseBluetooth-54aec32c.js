import{r as c,j as s}from"./index-712b8b73.js";import{u as v}from"./useSyncExternalStore-24e3b263.js";const d=()=>{const r=c.useRef(),n=c.useRef({isSupported:!!navigator&&"bluetooth"in navigator,isConnected:!1,device:null,server:null}),e=c.useRef({device:void 0,server:void 0}),o=c.useRef(async()=>{e.current.device&&e.current.device.gatt&&(e.current.server=await e.current.device.gatt.connect())}),u=c.useCallback(async t=>{try{navigator&&"bluetooth"in navigator&&(e.current.device=await navigator.bluetooth.requestDevice({...t??{},...(!t||!t.filters||t.filters.length===0)&&{acceptAllDevices:!0}}),e.current.device&&await o.current())}finally{r.current&&r.current()}},[]);return[v(c.useCallback(t=>(r.current=t,()=>{r.current=void 0}),[]),c.useCallback(()=>{var l;const t=!!navigator&&"bluetooth"in navigator,a=((l=e.current.server)==null?void 0:l.connected)??!1;return(n.current.isConnected!==a||n.current.isSupported!==t||n.current.device!==e.current.device||n.current.server!==e.current.server)&&(n.current={isSupported:t,isConnected:a,device:e.current.device,server:e.current.server}),n.current},[])),u]},h=()=>{var i;const[r,n]=d(),[e,o]=c.useState(""),u=c.useCallback(()=>{n().catch(t=>{t instanceof Error?o(t.message):o(t)})},[n]);return s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Bluetooth supported: ",r.isSupported?"Yes":"No"]}),r.isConnected&&s.jsxs("p",{children:["Device Name: ",(i=r.device)==null?void 0:i.name]}),s.jsx("button",{type:"button",onClick:u,disabled:!r.isSupported,children:"Get Bluetooth device"}),e&&s.jsx("p",{style:{color:"red"},children:e})]})};export{h as UseBluetooth};
