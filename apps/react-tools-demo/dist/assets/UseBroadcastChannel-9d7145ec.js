import{r as t,j as n}from"./index-3465b69f.js";import{u as m}from"./useSyncExternalStore-4b83f1b0.js";const f=(c,s,r)=>{const u=t.useRef(),o=t.useRef(),a=t.useRef(),l=t.useCallback(e=>{o.current=e.data,u.current&&u.current(),s&&s(e)},[s]),d=t.useCallback(e=>{a.current&&a.current.postMessage(e)},[]),i=m(t.useCallback(e=>(u.current=e,()=>u.current=void 0),[]),t.useMemo(()=>{let e=o.current;return()=>(e!==o.current&&(e=o.current),e)},[]));return t.useLayoutEffect(()=>{a.current=new BroadcastChannel(c),r&&(a.current.onmessageerror=r),a.current.onmessage=l},[c,l,r]),[i,d]},h=()=>{const[c,s]=f("react-tools");return n.jsxs("div",{children:[n.jsx("h2",{children:"Open page on multiple tab to see how hook work"}),n.jsxs("p",{children:["State: ",c]}),n.jsxs("form",{onSubmit:r=>{r.preventDefault(),s(r.target.elements.namedItem("text").value)},children:[n.jsx("input",{name:"text",type:"text"}),n.jsx("button",{type:"submit",children:"SEND"})]})]})};export{h as UseBroadcastChannel};
